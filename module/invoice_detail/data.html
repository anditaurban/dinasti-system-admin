<div class="bg-white p-6 rounded-lg shadow">
  <section class="space-y-6">

    <!-- Header -->
    <div class="flex flex-wrap items-start justify-between mb-4 gap-4">
      <div>
        <h1 id="pageTitle" class="text-2xl font-bold mb-1"></h1>
        <nav id="breadcrumb" class="text-gray-500 text-sm flex items-center flex-wrap gap-1"></nav>
      </div>
    </div>

    <!-- Search + Filter -->
    <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4 text-sm">

      <!-- Search -->
      <div class="w-full md:w-auto">
        <input type="text" id="project_name" name="project_name" placeholder="Project Name"
          class="hidden px-3 py-2 border rounded w-full md:w-96" />
      </div>

      <!-- Actions -->
      <div class="flex flex-wrap items-center justify-end gap-2 w-full md:w-auto">

        <button id="downloadBtn" onclick="printInvoice(detail_id)"
          class="bg-gray-700 hover:bg-gray-800 text-white px-4 py-2 rounded text-sm">
          üìÑ Download PDF
        </button>

        <button onclick="loadModuleContent('invoice')" class="bg-gray-300 text-sm px-4 py-2 rounded">
          ‚¨ÖÔ∏è Back
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="grid grid-cols-1 md:grid-cols-10 gap-6">

      <!-- Left Section: Items -->
      <div class="md:col-span-7">
        <section>
          <div class="overflow-auto border rounded">
            <table class="w-full text-sm">
              <thead class="bg-gray-100">
                <tr>
                  <th class="px-3 py-2 w-[5%] border text-center">No</th>
                  <th class="px-3 py-2 border text-left">Produk</th>
                  <th class="px-3 py-2 w-[12%] border text-right">Qty</th>
                  <th class="px-3 py-2 w-[10%] border text-right">Unit</th>
                  <th class="px-3 py-2 w-[17%] border text-right">Harga</th>
                  <th class="px-3 py-2 w-[12%] border text-right">Subtotal</th>
                </tr>
              </thead>
              <tbody id="tabelItem" class="bg-white"></tbody>
            </table>
          </div>
        </section>
      </div>

      <!-- Right Section: Info & Summary -->
      <aside class="md:col-span-3 bg-gray-50 p-4 rounded shadow space-y-4">

        <!-- Collapsible Template -->
        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('projectinfoSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üìÅ Project Info
            <span id="icon-projectinfoSection">‚ñº</span>
          </button>
          <div class="flex items-center gap-2">
            <button type="button" onclick="event.stopPropagation(); openEditInvoiceModal()"
              class="text-xs bg-yellow-50 text-yellow-700 px-2 py-1 rounded hover:bg-yellow-100">
              ‚úèÔ∏è Edit Info
            </button>
            <span id="icon-projectinfoSection">‚ñº</span>
          </div>
          <div id="projectinfoSection" class="px-4 py-3 space-y-3 text-sm text-gray-700">
            <div class="flex justify-between"><span id="project_name" class="font-medium">Project</span></div>
            <div class="flex justify-between"><span class="font-medium">No Invoice</span><span id="no_qtn"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">Tanggal Inv</span><span id="tanggal_inv"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">Due Date</span><span id="due_date"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">No PO</span><span id="no_po"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">Tanggal PO</span><span id="tanggal_po"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">Sales Type</span><span id="type_sales"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">Client</span><span id="client_name"
                class="text-gray-600">-</span></div>
            <div class="flex justify-between"><span class="font-medium">Notes</span><span id="internal_notes"
                class="text-gray-600">-</span></div>
          </div>
        </div>

        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('ringkasanSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üí° Ringkasan
            <span id="icon-ringkasanSection">‚ñº</span>
          </button>
          <div id="ringkasanSection" class="p-3 space-y-2">
            <p><span class="text-gray-500">Subtotal:</span> <span id="contract_amount" class="float-right">0</span></p>
            <p><span class="text-gray-500">Diskon:</span> <span id="diskon" class="float-right">0</span></p>

            <div class="flex justify-between items-center">
              <div class="flex items-center gap-2">
                <input type="checkbox" id="is_ppn_active" class="w-4 h-4 cursor-pointer">
                <span class="text-gray-500">Pajak (11%):</span>
              </div>
              <span id="ppn" class="font-medium text-gray-700">0</span>
            </div>

            <hr>
            <p class="font-bold">Total: <span id="total" class="float-right">0</span></p>
            <p class="font-bold">Payment: <span id="payment" class="float-right">0</span></p>
            <p class="font-bold">Outstanding: <span id="outstanding" class="float-right">0</span></p>
            <p class="font-bold">Status: <span id="status" class="float-right">Unpaid</span></p>
          </div>
        </div>

        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('uangMukaSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üí∞ Invoice Uang Muka
            <span id="icon-uangMukaSection">‚ñº</span>
          </button>
          <div id="uangMukaSection" class="p-3 space-y-2">
            <div class="text-gray-500 italic">-</div>
          </div>
          <div id="invoiceDPbutton" class="border-t p-3"></div>
        </div>

        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('pembayaranSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üí≥ Daftar Pembayaran
            <span id="icon-pembayaranSection">‚ñº</span>
          </button>
          <div id="pembayaranSection" class="p-3 space-y-2">
            <div class="text-gray-500 italic">-</div>
          </div>
          <div id="pembayaranbutton" class="border-t p-3"></div>
        </div>

        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('fileSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üìÇ File Pendukung
            <span id="icon-fileSection">‚ñº</span>
          </button>
          <div id="fileSection" class="p-3 space-y-2">
            <div class="text-gray-500 italic">-</div>
          </div>
          <!-- ... di dalam bagian File Pendukung ... -->
          <div class="border-t p-3 flex flex-col gap-2">
            <input type="file" id="files" name="files" multiple class="border rounded px-2 py-1 text-sm">
            <!-- GANTI onclick="editProjectWithFile()" MENJADI onclick="uploadInvoiceFile()" -->
            <button type="button" onclick="uploadInvoiceFile()"
              class="w-full py-1 px-2 border rounded bg-blue-50 text-blue-600 hover:bg-blue-100 text-xs">
              ‚úèÔ∏è Upload File
            </button>
          </div>
        </div>



        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('catatanSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üìù Catatan
            <span id="icon-catatanSection">‚ñº</span>
          </button>
          <div id="catatanSection" class="p-3 space-y-2">
            <div class="text-gray-500 italic">-</div>
          </div>
        </div>

        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('syaratKetentuanSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üìå Syarat & Ketentuan
            <span id="icon-syaratKetentuanSection">‚ñº</span>
          </button>
          <div id="syaratKetentuanSection" class="p-3 space-y-2">
            <div class="text-gray-500 italic">-</div>
          </div>
        </div>

        <div class="border rounded bg-white text-sm">
          <button onclick="toggleSection('topSection')"
            class="w-full flex justify-between items-center px-3 py-2 font-medium text-gray-700 border-b">
            üí∞ Term of Payment
            <span id="icon-topSection">‚ñº</span>
          </button>
          <div id="topSection" class="p-3 space-y-2">
            <div class="text-gray-500 italic">-</div>
          </div>
        </div>

      </aside>
    </div>
    <!-- MODAL PREVIEW (Overlay) -->
    <div id="previewModal" class="hidden fixed inset-0 z-[100] overflow-y-auto" aria-labelledby="modal-title"
      role="dialog" aria-modal="true">
      <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity backdrop-blur-sm" onclick="closePreview()">
      </div>
      <div class="flex items-center justify-center min-h-screen p-4 text-center sm:p-0">
        <div
          class="relative bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:max-w-4xl w-full flex flex-col max-h-[90vh]">
          <!-- Header -->
          <div class="bg-white px-4 py-3 border-b flex justify-between items-center sticky top-0 z-10">
            <h3 class="text-lg leading-6 font-bold text-gray-900 truncate pr-4">
              <span id="modalTitle">Preview File</span>
            </h3>
            <div class="flex items-center gap-2">
              <a id="btnDownload" href="#" target="_blank"
                class="text-gray-500 hover:text-blue-600 px-3 py-1 rounded hover:bg-blue-50 text-sm transition border">
                ‚¨áÔ∏è Download
              </a>
              <button onclick="closePreview()"
                class="text-gray-400 hover:text-red-500 focus:outline-none p-2 rounded hover:bg-red-50 transition">
                ‚ùå
              </button>
            </div>
          </div>
          <!-- Body -->
          <div class="p-0 bg-gray-100 flex-1 overflow-auto flex items-center justify-center min-h-[400px]">
            <img id="previewImage" src="" class="hidden max-w-full h-auto max-h-[80vh] object-contain shadow-lg"
              alt="Preview">
            <iframe id="previewFrame" src="" class="hidden w-full h-[80vh]" frameborder="0"></iframe>
            <div id="previewLoading" class="hidden flex flex-col items-center text-gray-400">
              <span class="text-2xl animate-spin">‚åõ</span>
              <span class="mt-2 text-sm">Memuat Preview...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>